package dev.tigr.ares.forge.impl.modules.exploit;

import dev.tigr.ares.core.feature.module.Category;
import dev.tigr.ares.core.feature.module.Module;
import dev.tigr.ares.core.setting.Setting;
import dev.tigr.ares.core.setting.settings.EnumSetting;
import dev.tigr.ares.core.util.global.ReflectionHelper;
import net.minecraft.client.Minecraft;
import net.minecraft.item.Item;
import net.minecraft.item.ItemEndCrystal;
import net.minecraft.item.ItemExpBottle;

/**
 * @author Tigermouthbear
 */
@Module.Info(name = "FastPlace", description = "Place blocks or use items faster", category = Category.PLAYER)
public class FastPlace extends Module {
    private final Setting<Whitelist> mode = register(new EnumSetting<>("Whitelist", Whitelist.ALL));

    @Override
    public void onTick() {
        Item item = MC.player.inventory.getCurrentItem().getItem();

        boolean isExp = item instanceof ItemExpBottle;
        boolean isCrystal = item instanceof ItemEndCrystal;

        switch(mode.getValue()) {
            case ALL:
                setClickDelay();
                break;
            case EXP:
                if(isExp)
                    setClickDelay();
                break;
            case CRYSTAL:
                if(isCrystal)
                    setClickDelay();
                break;
            case EXP_CRYSTAL:
                if(isCrystal || isExp)
                    setClickDelay();
                break;
        }
    }

    private void setClickDelay() {
        ReflectionHelper.setPrivateValue(Minecraft.class, MC, 0, "rightClickDelayTimer", "field_71467_ac");
    }

    @Override
    public String getInfo() {
        return mode.getValue().name();
    }

    enum Whitelist {
        ALL(),
        EXP(),
        CRYSTAL(),
        EXP_CRYSTAL()
    }
}
