package dev.tigr.ares.forge.impl.modules.exploit;

import dev.tigr.ares.core.feature.module.Category;
import dev.tigr.ares.core.feature.module.Module;
import dev.tigr.ares.core.setting.Setting;
import dev.tigr.ares.core.setting.settings.numerical.DoubleSetting;
import dev.tigr.ares.forge.event.events.player.PacketEvent;
import dev.tigr.ares.forge.event.events.player.StatusEffectEvent;
import dev.tigr.simpleevents.listener.EventHandler;
import dev.tigr.simpleevents.listener.EventListener;
import net.minecraft.init.Items;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.network.play.client.CPacketPlayer;
import net.minecraft.network.play.client.CPacketPlayerDigging;
import net.minecraft.potion.Potion;

@Module.Info(name = "BowNuker", description = "Game Ends people lol", category = Category.EXPLOIT)
public class BowNuker extends Module {

    private final Setting<Double> power = register(new DoubleSetting("Power", 20,0,100));

    @EventHandler
    public EventListener<PacketEvent.Sent> packetEventListener = new EventListener<>(event -> {
        if(event.getPacket() instanceof CPacketPlayerDigging) {

            CPacketPlayerDigging pk = (CPacketPlayerDigging) event.getPacket();

            if (pk.getAction().equals(CPacketPlayerDigging.Action.RELEASE_USE_ITEM) && MC.player.inventory.getCurrentItem().getItem().equals(Items.BOW))
                MC.player.connection.sendPacket(new CPacketPlayer.PositionRotation(MC.player.posX - Math.sin(MC.player.rotationYaw) * power.getValue(), MC.player.posY + 5, MC.player.posZ + Math.cos(MC.player.rotationYaw) * power.getValue(), MC.player.rotationYaw, MC.player.rotationPitch, false));
        }
    });

}
