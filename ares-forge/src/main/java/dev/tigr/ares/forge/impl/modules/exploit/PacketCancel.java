package dev.tigr.ares.forge.impl.modules.exploit;

import dev.tigr.ares.core.feature.module.Category;
import dev.tigr.ares.core.feature.module.Module;
import dev.tigr.ares.core.setting.Setting;
import dev.tigr.ares.core.setting.settings.BooleanSetting;
import dev.tigr.ares.forge.event.events.player.PacketEvent;
import dev.tigr.simpleevents.listener.EventHandler;
import dev.tigr.simpleevents.listener.EventListener;
import net.minecraft.network.play.client.*;

/**
 * @author Tigermouthbear
 */
@Module.Info(name = "PacketCancel", description = "Cancels certain packets", category = Category.EXPLOIT)
public class PacketCancel extends Module {
    private final Setting<Boolean> vehicleMove = register(new BooleanSetting("CPacketVehicleMove", true));
    private final Setting<Boolean> entityAction = register(new BooleanSetting("CPacketEntityAction", true));
    private final Setting<Boolean> entityUse = register(new BooleanSetting("CPacketUseEntity", true));
    private final Setting<Boolean> input = register(new BooleanSetting("CPacketInput", true));
    private final Setting<Boolean> player = register(new BooleanSetting("CPacketPlayer", true));
    private final Setting<Boolean> playerAbilities = register(new BooleanSetting("CPacketPlayerAbilities", true));
    private final Setting<Boolean> playerDigging = register(new BooleanSetting("CPacketPlayerDigging", true));
    private final Setting<Boolean> playerTryUseItem = register(new BooleanSetting("CPacketPlayerTryUseItem", true));
    private final Setting<Boolean> playerTryUseItemBlock = register(new BooleanSetting("CPacketPlayerTryUseItemOnBlock", true));

    @EventHandler
    public EventListener<PacketEvent.Sent> packetSentEvent = new EventListener<>(event -> {
        if(event.getPacket() instanceof CPacketVehicleMove && vehicleMove.getValue()) event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketEntityAction && entityAction.getValue()) event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketUseEntity && entityUse.getValue()) event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketInput && input.getValue()) event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketPlayer && player.getValue()) event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketPlayerAbilities && playerAbilities.getValue())
            event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketPlayerDigging && playerDigging.getValue())
            event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketPlayerTryUseItem && playerTryUseItem.getValue())
            event.setCancelled(true);
        else if(event.getPacket() instanceof CPacketPlayerTryUseItemOnBlock && playerTryUseItemBlock.getValue())
            event.setCancelled(true);
    });
}
