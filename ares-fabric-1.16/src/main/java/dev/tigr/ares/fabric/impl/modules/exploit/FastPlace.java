package dev.tigr.ares.fabric.impl.modules.exploit;

import dev.tigr.ares.core.feature.module.Category;
import dev.tigr.ares.core.feature.module.Module;
import dev.tigr.ares.core.setting.Setting;
import dev.tigr.ares.core.setting.settings.EnumSetting;
import dev.tigr.ares.fabric.mixin.accessors.MinecraftClientAccessor;
import net.minecraft.item.EndCrystalItem;
import net.minecraft.item.ExperienceBottleItem;
import net.minecraft.item.Item;

/**
 * @author Tigermouthbear
 */
@Module.Info(name = "FastPlace", description = "Place blocks or use items faster", category = Category.PLAYER)
public class FastPlace extends Module {
    private final Setting<Whitelist> mode = register(new EnumSetting<>("Whitelist", Whitelist.ALL));

    @Override
    public void onTick() {
        Item item = MC.player.inventory.getMainHandStack().getItem();

        boolean isExp = item instanceof ExperienceBottleItem;
        boolean isCrystal = item instanceof EndCrystalItem;

        switch(mode.getValue()) {
            case ALL:
                setClickDelay();
                break;
            case EXP:
                if(isExp)
                    setClickDelay();
                break;
            case CRYSTAL:
                if(isCrystal)
                    setClickDelay();
                break;
            case EXP_CRYSTAL:
                if(isCrystal || isExp)
                    setClickDelay();
                break;
        }
    }

    private void setClickDelay() {
        ((MinecraftClientAccessor) MC).setItemUseCooldown(0);
    }

    @Override
    public String getInfo() {
        return mode.getValue().name();
    }

    enum Whitelist {
        ALL(),
        EXP(),
        CRYSTAL(),
        EXP_CRYSTAL()
    }
}
